<!DOCTYPE html><html lang="zh-TW"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/shan-logo-appletouch.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/shan-logo.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/shan-logo-16X16.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><script class="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"blog.rosa.tw",root:"/",scheme:"Gemini",version:"8.0.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,"Pisces | Gemini":240},copycode:!0,bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!0,pangu:!1,comments:{style:"buttons",active:!0,storage:!0,lazyload:!0,nav:{disqus:{text:"ç•™è¨€å€",order:-1}},"Available values":"disqus"},motion:{enable:!1,async:!1,transition:{post_block:"fadeIn",post_header:"fadeInDown",post_body:"fadeInDown",coll_header:"fadeInLeft",sidebar:"fadeInUp"}},prism:!1,i18n:{placeholder:"æœå°‹...",empty:"We didn't find any results for the search: ${query}",hits_time:"${hits} results found in ${time} ms",hits:"${hits} results found"},path:"search.xml",localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1}}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-S8ZEBJDRWG"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-S8ZEBJDRWG")</script><meta name="description" content="æ–‡ç« ä¾†è‡ª :  Higher-Order Components â€“ React   æ‘˜è¦  äº†è§£ HOC çš„é‹ä½œåŸç†ï¼Œä»¥åŠæ„ç¾© HOC çš„æ¶æ§‹èˆ‡å¯¦ä½œ HOC æ‡‰ç”¨ä¸Šçš„æ³¨æ„äº‹é …"><meta property="og:type" content="article"><meta property="og:title" content="ç­†è¨˜ | React - Higher Order Component (HOC)"><meta property="og:url" content="https://blog.rosa.tw/2022/07/React/Higher-Order-Component"><meta property="og:site_name" content="å¥å¿˜é›œè¨˜"><meta property="og:description" content="æ–‡ç« ä¾†è‡ª :  Higher-Order Components â€“ React   æ‘˜è¦  äº†è§£ HOC çš„é‹ä½œåŸç†ï¼Œä»¥åŠæ„ç¾© HOC çš„æ¶æ§‹èˆ‡å¯¦ä½œ HOC æ‡‰ç”¨ä¸Šçš„æ³¨æ„äº‹é …"><meta property="og:locale" content="zh_TW"><meta property="og:image" content="https://i.imgur.com/6tr37Nj.gif"><meta property="og:image" content="https://i.imgur.com/Hq7kYZg.gif"><meta property="og:image" content="https://i.imgur.com/V4Uk0fb.png"><meta property="og:image" content="https://i.imgur.com/e3103Wo.png"><meta property="og:image" content="https://i.imgur.com/GgF9oDS.gif"><meta property="og:image" content="https://i.imgur.com/j4Uec3j.gif"><meta property="article:published_time" content="2022-07-26T22:30:10.000Z"><meta property="article:modified_time" content="2022-07-31T10:19:43.042Z"><meta property="article:author" content="Rosa Hong"><meta property="article:tag" content="React"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://i.imgur.com/6tr37Nj.gif"><link rel="canonical" href="https://blog.rosa.tw/2022/07/React/Higher-Order-Component.html"><script class="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-TW"}</script><title>ç­†è¨˜ | React - Higher Order Component (HOC) | å¥å¿˜é›œè¨˜</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-S8ZEBJDRWG"></script><script>if(CONFIG.hostname===location.hostname){function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-S8ZEBJDRWG")}</script><noscript><style>body{margin-top:2rem}.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header,.use-motion .sidebar{visibility:visible}.use-motion .footer,.use-motion .header,.use-motion .site-brand-container .toggle{opacity:initial}.use-motion .custom-logo-image,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line{transform:scaleX(1)}.search-pop-overlay,.sidebar-nav{display:none}.sidebar-panel{display:block}</style></noscript><link rel="alternate" href="/atom.xml" title="å¥å¿˜é›œè¨˜" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="åˆ‡æ›å°èˆªæ¬„"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><h1 class="site-title">å¥å¿˜é›œè¨˜</h1><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">ç´€éŒ„å­¸ç¿’èˆ‡ç”Ÿæ´»</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i> é¦–é </a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i> æ¨™ç±¤<span class="badge">21</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i> åˆ†é¡<span class="badge">15</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i> æ­¸æª”<span class="badge">54</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> æœå°‹</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="æœå°‹..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> æ–‡ç« ç›®éŒ„</li><li class="sidebar-nav-overview"> æœ¬ç«™æ¦‚è¦</li></ul><section class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%91%98%E8%A6%81-4"><span class="nav-number">1.</span> <span class="nav-text">æ‘˜è¦</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%80%E9%BA%BC%E6%98%AF-Higher-Order-Component"><span class="nav-number">2.</span> <span class="nav-text">ä»€éº¼æ˜¯ Higher Order Component ?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HOC-%E7%9A%84%E6%9E%B6%E6%A7%8B"><span class="nav-number">3.</span> <span class="nav-text">HOC çš„æ¶æ§‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A9%AB%E5%88%87%E9%97%9C%E6%B3%A8%E9%BB%9E-Cross-cutting-concern"><span class="nav-number">4.</span> <span class="nav-text">æ©«åˆ‡é—œæ³¨é» (Cross-cutting concern)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%A6%E4%BD%9C%E7%B7%B4%E7%BF%92"><span class="nav-number">5.</span> <span class="nav-text">å¯¦ä½œç·´ç¿’</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HOC-withToggle"><span class="nav-number">5.1.</span> <span class="nav-text">HOC withToggle</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Accordion"><span class="nav-number">5.2.</span> <span class="nav-text">Accordion</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Navbar-fullwidth"><span class="nav-number">5.3.</span> <span class="nav-text">Navbar fullwidth</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%88%E6%9E%9C"><span class="nav-number">5.4.</span> <span class="nav-text">æ•ˆæœ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%8D%E5%8C%85%E8%A3%9D-Navbar-withNavbarType"><span class="nav-number">5.5.</span> <span class="nav-text">å†åŒ…è£ Navbar : withNavbarType</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%85%A3%E4%BE%8B-%E4%BD%BF%E7%94%A8-HOC-%E5%82%B3%E9%81%9E%E4%B8%8D%E7%9B%B8%E9%97%9C%E7%9A%84-props"><span class="nav-number">6.</span> <span class="nav-text">æ…£ä¾‹ : ä½¿ç”¨ HOC å‚³éä¸ç›¸é—œçš„ props</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%85%A3%E4%BE%8B-%E6%9C%80%E5%A4%A7%E5%8C%96%E7%9A%84%E5%8F%AF%E7%B5%84%E5%90%88%E6%80%A7-Maximizing-Composability"><span class="nav-number">7.</span> <span class="nav-text">æ…£ä¾‹ : æœ€å¤§åŒ–çš„å¯çµ„åˆæ€§ (Maximizing Composability)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%85%A3%E4%BE%8B-%E7%94%A8-displayName-%E5%8F%96%E5%90%8D%E5%AD%97%E5%B9%AB%E5%8A%A9-Debug"><span class="nav-number">8.</span> <span class="nav-text">æ…£ä¾‹ : ç”¨ displayName å–åå­—å¹«åŠ© Debug</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F-%E4%B8%8D%E8%A6%81%E7%9B%B4%E6%8E%A5%E4%BF%AE%E6%94%B9%E5%88%B0%E5%8E%9F%E6%9C%AC%E7%9A%84-Component"><span class="nav-number">9.</span> <span class="nav-text">æ³¨æ„ : ä¸è¦ç›´æ¥ä¿®æ”¹åˆ°åŸæœ¬çš„ Component</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F-%E4%B8%8D%E8%A6%81%E5%9C%A8-render-function-%E4%BD%BF%E7%94%A8-HOC"><span class="nav-number">10.</span> <span class="nav-text">æ³¨æ„ : ä¸è¦åœ¨ render function ä½¿ç”¨ HOC</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F-refs-%E4%B8%A6%E4%B8%8D%E6%9C%83%E8%A2%AB%E5%82%B3%E9%81%9E"><span class="nav-number">11.</span> <span class="nav-text">æ³¨æ„ : refs ä¸¦ä¸æœƒè¢«å‚³é</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B8%BD%E7%B5%90-26"><span class="nav-number">12.</span> <span class="nav-text">ç¸½çµ</span></a></li></ol></div></section><section class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Rosa Hong" src="/images/RosaBlog-LOGO.png"><p class="site-author-name" itemprop="name">Rosa Hong</p><div class="site-description" itemprop="description">èœé³¥èµ·é£›ä¸­</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">54</span> <span class="site-state-item-name">æ–‡ç« </span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">15</span> <span class="site-state-item-name">åˆ†é¡</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">21</span> <span class="site-state-item-name">æ¨™ç±¤</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/meitung473" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;meitung473" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a></span><span class="links-of-author-item"><a href="mailto:a8870506@gmail.com" title="è¯çµ¡æˆ‘ â†’ mailto:a8870506@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a></span><span class="links-of-author-item"><a href="https://www.facebook.com/yanshan.hong1" title="Rosa Hong â†’ https:&#x2F;&#x2F;www.facebook.com&#x2F;yanshan.hong1" rel="noopener" target="_blank"><i class="fa fa-facebook fa-fw"></i></a></span></div></section></div></aside><div class="sidebar-dimmer"></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW"><link itemprop="mainEntityOfPage" href="https://blog.rosa.tw/2022/07/React/Higher-Order-Component"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/RosaBlog-LOGO.png"><meta itemprop="name" content="Rosa Hong"><meta itemprop="description" content="èœé³¥èµ·é£›ä¸­"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="å¥å¿˜é›œè¨˜"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> ç­†è¨˜ | React - Higher Order Component (HOC)</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">ç™¼è¡¨æ–¼</span> <time title="å‰µå»ºæ™‚é–“ï¼š2022-07-27 06:30:10" itemprop="dateCreated datePublished" datetime="2022-07-27T06:30:10+08:00">2022-07-27</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">åˆ†é¡æ–¼</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-end/" itemprop="url" rel="index"><span itemprop="name">Front-end</span></a></span> ï¼Œ <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-end/React/" itemprop="url" rel="index"><span itemprop="name">React</span></a></span></span></div><div class="post-meta"><span class="post-meta-item" title="æ–‡ç« å­—æ•¸"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">æ–‡ç« å­—æ•¸ï¼š</span> <span>14k</span></span><span class="post-meta-item" title="æ‰€éœ€é–±è®€æ™‚é–“"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">æ‰€éœ€é–±è®€æ™‚é–“ &asymp;</span> <span>12 åˆ†é˜</span></span></div></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>æ–‡ç« ä¾†è‡ª :</p><ol><li><a href="https://zh-hant.reactjs.org/docs/higher-order-components.html">Higher-Order Components â€“ React</a></li></ol></blockquote><h2 id="æ‘˜è¦-4">æ‘˜è¦</h2><ol><li>äº†è§£ HOC çš„é‹ä½œåŸç†ï¼Œä»¥åŠæ„ç¾©</li><li>HOC çš„æ¶æ§‹èˆ‡å¯¦ä½œ</li><li>HOC æ‡‰ç”¨ä¸Šçš„æ³¨æ„äº‹é …</li></ol><span id="more"></span><h2 id="ä»€éº¼æ˜¯-Higher-Order-Component">ä»€éº¼æ˜¯ Higher Order Component ?</h2><p>HOC æ˜¯ä¸€å€‹ functionï¼ŒæŠŠå¦ä¸€å€‹å…ƒä»¶çš„é‚è¼¯åŒ…èµ·ä¾†ï¼Œç”¢ç”Ÿæ–°çš„ <strong>åŠ å¼·ç‰ˆ</strong> å…ƒä»¶ï¼Œ ä½¿å…ƒä»¶å…§éƒ¨çš„é‚è¼¯å¯ä»¥é‡è¤‡ä½¿ç”¨ã€‚è€Œä¸”ä¸æœƒå‹•åˆ°åŸæœ¬ Component çš„çµæ§‹ï¼Œè€Œæ˜¯åŠ ä¸Š HOC å¸¶ä¾†çš„åŠŸèƒ½ã€‚</p><p>è¢«å…±ç”¨çš„é‚è¼¯æ˜¯å°è£åœ¨è£¡é¢ï¼Œå¤§éƒ¨åˆ†ç¬¬ä¸‰æ–¹ library éƒ½æ˜¯é€™éº¼ä½¿ç”¨ã€‚<br> ä¾‹å¦‚ : react-redux è£¡ <code>connect()</code> å°±æ˜¯ä¸€å€‹ HOCã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">NewComponent</span> = <span class="title function_">connect</span>(<span class="title class_">StoreProp</span>,<span class="title class_">StateProps</span>)(<span class="title class_">Component</span>);</span><br></pre></td></tr></table></figure><blockquote><p>HOC çš„é‡é»æ˜¯æ¸›å°‘é¡ä¼¼åŠŸèƒ½å…ƒä»¶çš„ <strong>é‡è¤‡é‚è¼¯</strong>ï¼Œæé«˜å…ƒä»¶çš„é‡ç”¨æ€§ (reusable)ã€‚</p></blockquote><p>èˆ‰å€‹å¯¦éš›ä¾‹å­ï¼Œtodolist å…·æœ‰ toggle åŠŸèƒ½ï¼Œä¹Ÿå¾ˆå¤šå€‹ button ä¹Ÿæœ‰ (åˆ‡æ›èƒŒæ™¯é¡è‰²å•¦ç­‰ç­‰)ï¼Œå…©è€…å…·æœ‰ <code>open State</code> ä¸¦ä¸” <code>setOpen</code> åªè² è²¬åˆ‡æ› true &amp; false ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é€™ä¸€æ®µé‚è¼¯ä¸æ–·çš„é‡è¤‡æ’°å¯«ï¼ŒæŠŠå®ƒæå‡ºä¾† åšæˆ withToggleï¼ŒæŠŠ toggle åŠŸèƒ½å°è£</span></span><br><span class="line"><span class="keyword">const</span> [open,setOpen] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleToggle</span> = (<span class="params"></span>)=&gt;&#123;</span><br><span class="line">	<span class="title function_">setOpen</span>(<span class="function">(<span class="params">prevOpen</span>)=&gt;</span> !prevOpen)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>toggle é€™å€‹é‚è¼¯è¦è¢«æŠ½æˆå¯é‡è¤‡æ€§çš„é‚è¼¯ï¼Œæ‰€ä»¥ HOC å¯ä»¥æ˜¯ä¸€å€‹å« <code>withtoggle(&lt;Component/&gt;)</code>ï¼Œåˆç¨±å…·æœ‰ toggle åŠŸèƒ½, çš„ Componentã€‚</p><h2 id="HOC-çš„æ¶æ§‹">HOC çš„æ¶æ§‹</h2><p>æœ€åŸºæœ¬çš„æ¶æ§‹æ˜¯åŒ…è£¹è‘—å¦ä¸€å€‹ Componentï¼Œå›å‚³çš„æ˜¯ä¸€å€‹æ–°çš„ Componentã€‚å…¶ä»–åƒæ•¸å¯ä»¥è‡ªè¨‚ï¼Œä¹Ÿå¯ä»¥å‚³å…¥æƒ³è¦å…±åŒä½¿ç”¨ dataã€‚</p><blockquote><p>HOC æ˜¯ä¸€å€‹ pure function (same input ,same output)ï¼Œä¸å…·æœ‰å‰¯ä½œç”¨ (side effects)</p></blockquote><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">NewComponent</span> = <span class="title function_">higherFunction</span>(<span class="title class_">WrappedComponent</span>);</span><br></pre></td></tr></table></figure><p>HOC <strong>ä¸æ˜¯ç”¨ç¹¼æ‰¿çš„æ–¹å¼</strong> ä¾†ç”¢ç”Ÿæ–°çš„ Component ï¼Œè€Œæ˜¯ <strong>composed</strong> (é‡çµ„)ã€‚<br> å¯ä»¥çœ‹æ˜¯ä¸€å€‹æ–°å®¹å™¨ (Container)ã€‚å…¶åƒæ•¸æ˜¯ä¸é™çš„ï¼Œå¦å¤– HOC ä¸ç®¡è³‡æ–™çš„ä¾†æºå‡ºè™•ï¼Œå®ƒåªæ˜¯è² è²¬é–‹ä¸€å€‹é€šé“ï¼Œè®“è¢«åŒ…ä½çš„ Component çœå»åšé‡è¤‡å‹•ä½œã€‚</p><p>functional Component</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">EnhancedComponent</span> = (<span class="params">WrappedComponent</span>) =&gt;&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">props</span>)&#123;</span><br><span class="line">		<span class="comment">// è¨˜å¾—æŠŠ props é‚„å›å»</span></span><br><span class="line">		<span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;<span class="attr">...props</span>&#125;/&gt;</span></span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>class Component</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">EnhancedComponent</span> = (<span class="params">WrappedComponent</span>) =&gt;&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">class</span> <span class="title class_">extends</span> <span class="title class_">React</span>.<span class="property">Component</span>&#123;</span><br><span class="line">		<span class="keyword">return</span>()&#123;</span><br><span class="line">			<span class="comment">// ä¸€æ¨£è¦æŠŠ props é‚„å›å»</span></span><br><span class="line">			<span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;<span class="attr">...props</span>&#125;/&gt;</span></span></span><br><span class="line">		&#125; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€™è£¡çš„ <code>&#123;...props&#125;</code> æ˜¯ <code>&lt;NewComponent&gt;</code> å‚³å…¥çš„ propsã€‚</p><p>ä¾‹ : <code>&lt;WithToggleCompoent index=&quot;1&quot;/&gt;</code> åƒæ˜¯ index é€™å€‹ propsï¼Œåœ¨ä¸å½±éŸ¿åŸæœ¬ <code>&lt;WrappedComponent/&gt;</code>æƒ…æ³ä¸‹æŠŠ <code>props</code> éƒ½å¡å›å»ã€‚å¦‚æœæ²’æœ‰ <code>&#123;...props&#125;</code> é€™æ­¥é©Ÿï¼Œå°±ä¸æœƒæ¥æ”¶åˆ° HOC åŒ…è£¹çš„æ•ˆæœã€‚</p><h2 id="æ©«åˆ‡é—œæ³¨é»-Cross-cutting-concern">æ©«åˆ‡é—œæ³¨é» (Cross-cutting concern)</h2><p>é‚è¼¯æ˜¯é€é HOC æ”œå¸¶çš„ï¼Œä¸¦ä¸æ˜¯ç¡¬ç”Ÿç”ŸåµŒå…¥åœ¨æŸå…ƒä»¶çš„ç¨‹å¼ç¢¼ä¸­ï¼Œæœ‰åŠ©æ–¼ <strong>æ©«åˆ‡é—œæ³¨é»</strong>ã€‚</p><p>ç¯„ä¾‹æƒ…å¢ƒ :</p><ol><li>æœ‰ä¸€ a å…ƒä»¶éœ€è¦é™„å¸¶ A åŠŸèƒ½ï¼ŒåŠŸèƒ½ A è¢«é–‹ç™¼ï¼Œç”±æ–¼ç›®å‰åªæœ‰ a å…ƒä»¶éœ€è¦ï¼Œç›´æ¥å°‡é‚è¼¯å¯«æ­»åœ¨ a å…ƒä»¶ä¸Šã€‚</li><li>æŸä¸€å¤© a å…ƒä»¶éœ€è¦è¢«æ›´æ–°æ”¹æˆ b å…ƒä»¶ï¼Œå…¶ä¸­ A åŠŸèƒ½éœ€è¦è¢«ä¿ç•™ï¼Œå…¶é¤˜éƒ½ä¸è¦ï¼Œé€™æ™‚å€™éœ€è¦æŒ–å‡º A åŠŸèƒ½çš„ä»£ç¢¼ä¸¦é€²è¡Œé‡æ§‹ã€‚</li><li>é‚£å¦‚æœæŸå¤© b å…ƒä»¶åˆä¸è¦ A åŠŸèƒ½å‘¢ ?</li></ol><blockquote><p>å°è‡´å…ƒä»¶çš„ä»£ç¢¼å°±æœƒä¸€ç›´è¢«é‡æ§‹ğŸ˜µï¼Œæ˜¯å¾ˆç³Ÿçš„è¡Œç‚º</p></blockquote><p>æ©«åˆ‡é—œæ³¨é»çš„æ¦‚å¿µä½¿å¾— A åŠŸèƒ½è¢«æŠ½å–å‡ºä¾†ï¼Œä¸¦æ¡ç”¨ <strong>æ·»åŠ </strong> çš„æ–¹å¼åŠ åˆ°éœ€è¦çš„å…ƒä»¶èº«ä¸Šã€‚é‚è¼¯è¢«åˆ†é–‹çš„ç‹€æ³ï¼Œå¦‚æœçªç„¶ä¸æƒ³è¦ A åŠŸèƒ½éš¨æ™‚éƒ½æŠ½å–æ‰ï¼ŒåŸæœ¬çš„å…ƒä»¶ä¹Ÿä¸æœƒè¢«å—å½±éŸ¿ã€‚</p><p>HOC ä¹‹æ‰€ä»¥èªªæ˜¯åŠ å¼·ç‰ˆçš„å…ƒä»¶ï¼Œå®ƒè¿½åŠ æ–°çš„åŠŸèƒ½åœ¨åŸæœ¬çš„å…ƒä»¶ä¸Šï¼Œä½†ä¹Ÿä¸å½±éŸ¿åŸæœ¬çš„å…ƒä»¶ã€‚</p><h2 id="å¯¦ä½œç·´ç¿’">å¯¦ä½œç·´ç¿’</h2><p>codepen ğŸ‘‰ <a href="https://codepen.io/shan473/pen/WNzjdmJ">React - HOC practice</a></p><p>å‡¡æ˜¯æœ‰æ“ä½œé–‹é–‹é—œé—œçš„ Component ï¼ŒåŒ…æˆ <code>withToggle</code> çš„ HOCï¼ŒæŠŠåŒæ¨£çš„ <strong>é–‹é—œé‚è¼¯</strong> æŠ½å‡ºä¾†ã€‚ä»¥ W3school çš„ <a href="https://www.w3schools.com/howto/howto_js_sidenav.asp">Navbar</a> èˆ‡ <a href="https://www.w3schools.com/howto/howto_js_accordion.asp">Accordion</a> ç‚ºä¾‹ã€‚</p><h3 id="HOC-withToggle">HOC withToggle</h3><ul><li>å»ºç«‹ä¸€å€‹ HOC - <code>withToggle</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">withToggle</span> = (<span class="params">Component</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">props</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> [open,setOpen] =<span class="title class_">React</span>.<span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">togglehandler</span> = (<span class="params"></span>)=&gt; &#123;<span class="title function_">setOpen</span>(<span class="function"><span class="params">prevOpen</span> =&gt;</span> !prevOpen)&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">Component</span> <span class="attr">open</span>=<span class="string">&#123;open&#125;</span> <span class="attr">togglehandler</span>=<span class="string">&#123;togglehandler&#125;</span> &#123;<span class="attr">...props</span>&#125;/&gt;</span></span> </span><br><span class="line">    )</span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ </span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AccordionWithToggle</span> =  <span class="title function_">withToggle</span>(<span class="title class_">Accordion</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">NavbarWithToggle</span> = <span class="title function_">withToggle</span>(<span class="title class_">Navbar</span>);</span><br></pre></td></tr></table></figure><p>ä¸»è¦å‚³å…¥çš„ props æ˜¯ <code>open</code> çš„ state ï¼Œèˆ‡ <code>togglehandler</code> é€™å€‹ method</p><h3 id="Accordion">Accordion</h3><p>åŸºæœ¬çš„ Accordion (æ‰‹é¢¨ç´)ï¼Œæ‰‹é¢¨ç´æœ€é‡è¦çš„å°±æ˜¯æ”¹è®Š <code>maxheight</code> è®“å…§å®¹ä¼¸ç¸®ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Accordion</span>(<span class="params">&#123;open,togglehandler,index&#125;</span>)&#123;</span><br><span class="line">	<span class="comment">// 1. å…§å®¹çš„é«˜åº¦è³‡æ–™</span></span><br><span class="line"> <span class="keyword">const</span> [panelheight,setPanelHeight] = <span class="title class_">React</span>.<span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line"> <span class="comment">/* </span></span><br><span class="line"><span class="comment">	 2. ä½¿ç”¨ callback refï¼Œé€é ref æ‹¿åˆ° DOM å…§å®¹çš„é«˜åº¦ï¼Œä¸¦æ ¹æ“š é–‹é—œ open ä¾†æ±ºå®šé«˜åº¦</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">  <span class="keyword">const</span> panelref = <span class="title class_">React</span>.<span class="title function_">useCallback</span>(<span class="function">(<span class="params">node</span>)=&gt;</span>&#123;</span><br><span class="line">     <span class="keyword">if</span>(node!==<span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!open)&#123;</span><br><span class="line">          <span class="title function_">setPanelHeight</span>(node.<span class="property">scrollHeight</span>)</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">         <span class="title function_">setPanelHeight</span>(<span class="number">0</span>)</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;,[open])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  &#123;/* 3. å¡«å…¥ HOC å‚³å…¥çš„ togglehandler */&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&quot;accordion&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;togglehandler&#125;</span>&gt;</span>Section &#123;index+1&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">		&#123;/* 4. æ”¹è®Š maxHeight */&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;panel&quot;</span> <span class="attr">ref</span>=<span class="string">&#123;panelref&#125;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">maxHeight:</span> <span class="attr">panelheight</span>+&#x27;<span class="attr">px</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Navbar-fullwidth">Navbar fullwidth</h3><p>é‡é»æ˜¯æ”¹è®Š <code>width</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Navbar</span>(<span class="params">&#123;open,togglehandler,type&#125;</span>)&#123;</span><br><span class="line">	<span class="comment">// 1. width çš„ state </span></span><br><span class="line">  <span class="keyword">const</span> [width,setWidth] = <span class="title class_">React</span>.<span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 2. ç›£è½ open çš„è®ŠåŒ–</span></span><br><span class="line">  <span class="title class_">React</span>.<span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(open)&#123;</span><br><span class="line">      <span class="title function_">setWidth</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="title function_">setWidth</span>(<span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,[open])</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	   &#123;/* 3. æ”¹è®Š width */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;sidenav&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">width</span> <span class="attr">:</span> <span class="attr">width</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:void(0)&quot;</span> <span class="attr">className</span>=<span class="string">&quot;closebtn&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;togglehandler&#125;</span>&gt;</span><span class="symbol">&amp;times;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>About<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>Services<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>Clients<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>Contact<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* 4. å¡«å…¥ HOC å‚³å…¥çš„ togglehandler */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;togglehandler&#125;</span>&gt;</span>open<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ•ˆæœ">æ•ˆæœ</h3><p><img data-src="https://i.imgur.com/6tr37Nj.gif" alt=""><br> å¦‚æ­¤ä¸€ä¾†æˆ‘å€‘åªè¦å¹«å…ƒä»¶åŒ…ä¸Š <code>withToggle</code> éƒ½å¯ä»¥æ“æœ‰é–‹é–‹é—œé—œçš„åŠŸèƒ½ã€‚<br> çœ‹åˆ° w3school çš„ Navbar ç¯„ä¾‹æœ‰å¾ˆå¤šæ¬¾ï¼Œæˆ‘æ±ºå®šå†ä¾†å¯¦ä½œå¯ä»¥ä¾ç…§ä¸åŒé¡å‹ç”¢ç”Ÿå®¢è£½åŒ–çš„ NavbarğŸ˜ã€‚</p><h3 id="å†åŒ…è£-Navbar-withNavbarType">å†åŒ…è£ Navbar : withNavbarType</h3><p>ä¸åŒçš„ type ï¼Œ width ä¸ä¸€æ¨£ã€‚ä¸€é–‹å§‹æ–°å¢ type çš„åƒæ•¸ä¾†é”æˆæ•ˆæœã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ©ç”¨ Object bracket notation çš„ç‰¹æ€§ï¼Œå¸¶å­—ä¸²ç•¶ç´¢å¼•</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Navtype</span> = &#123;</span><br><span class="line">  <span class="title class_">Full</span> : <span class="string">&#x27;100%&#x27;</span>,</span><br><span class="line">  <span class="title class_">Overlay</span>: <span class="string">&#x27;250px&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">withNavbarType</span> =(<span class="params">CoreComponent,type</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">props</span>)=&gt;</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">CoreComponent</span> <span class="attr">type</span>=<span class="string">&#123;Navtype[type]&#125;</span> &#123;<span class="attr">...props</span>&#125;/&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">FullNavbar</span> = <span class="title function_">withNavbarType</span>(<span class="title function_">withToggle</span>(<span class="title class_">Navbar</span>,<span class="string">&#x27;Full&#x27;</span>))</span><br></pre></td></tr></table></figure><p>ä½†åˆè¦ºå¾—é€™æ¨£å¾ˆä¸å„ªé›…ğŸ˜µï¼Œæƒ³è®Šæˆ <code>const FullNavbar = customNavbar(type)</code> ï¼Œè®“æ¯æ¬¡è¼¸å…¥éƒ½åªå‰©ä¸€å€‹åƒæ•¸ (æŸ¯é‡ŒåŒ–)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Navtype</span> = &#123;</span><br><span class="line">  <span class="title class_">Full</span> : <span class="string">&#x27;100%&#x27;</span>,</span><br><span class="line">  <span class="title class_">Overlay</span>: <span class="string">&#x27;250px&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. è®“ type æˆç‚ºæœ€å¾Œä¸€å€‹åƒæ•¸ï¼Œåªè¦æ·»å…¥å°æ‡‰å­—ä¸²å°±å¥½</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">withNavbarType</span> =(<span class="params">CoreComponent</span>)=&gt; <span class="function">(<span class="params">type</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">props</span>)=&gt;</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">CoreComponent</span> <span class="attr">type</span>=<span class="string">&#123;Navtype[type]&#125;</span> &#123;<span class="attr">...props</span>&#125;/&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2. æŠŠåŸæœ¬çš„åŠŸèƒ½åŠ ä¸€åŠ ï¼Œè®Šæˆ å®¢è£½åŒ–çš„ Navbar</span></span><br><span class="line"><span class="keyword">const</span> customNavbar = <span class="title function_">withNavbarType</span>(<span class="title function_">withToggle</span>(<span class="title class_">Navbar</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. å¸¶å…¥æƒ³è¦çš„ style string å°±å¯ä»¥ç”¢ç”Ÿå°æ‡‰çš„ Navbar</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">FullNavbar</span> = <span class="title function_">customNavbar</span>(<span class="string">&#x27;Full&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">OverlayNavbar</span> = <span class="title function_">customNavbar</span>(<span class="string">&#x27;Overlay&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ¥è‘—ä¿®æ”¹ <code>&lt;Navbar/&gt;</code> çš„å…¶ä¸­ä¸€å€‹éƒ¨ä»½</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">React</span>.<span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(open)&#123;</span><br><span class="line">		<span class="comment">// æ”¹æˆæŒ‰ç…§ prop å‚³å…¥çš„ type æ”¹è®Š width</span></span><br><span class="line">		<span class="title function_">setWidth</span>(type)</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="title function_">setWidth</span>(<span class="number">0</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;,[open])</span><br></pre></td></tr></table></figure><p>æ­å•¦ ! å°±å¯ä»¥æ“æœ‰ä¸åŒçš„å®¢è£½åŒ– Navbarã€‚<br> <img data-src="https://i.imgur.com/Hq7kYZg.gif" alt=""><br> å¥½è™•æ˜¯ <strong>ä¸ç”¨åœ¨åŸæœ¬çš„ Navbar å…ƒä»¶å…§åˆ¤æ–· type æ˜¯ä»€éº¼æ‰åšä¸åŒçš„ width è®ŠåŒ–</strong> ï¼Œåªè¦å°ˆæ³¨åœ¨ Navbar çš„åŠŸèƒ½å°±å¥½ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âŒ æˆ‘è¦ºå¾—ä¸æ˜¯å¾ˆå¥½çš„ pattern</span></span><br><span class="line"><span class="title class_">React</span>.<span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">	<span class="comment">// ğŸ˜µ å¦‚æœæ²’æœ‰æŠ½å‡ºä¾†ï¼Œåœ¨å…ƒä»¶è£¡é¢åˆ¤æ–·</span></span><br><span class="line">	<span class="keyword">let</span> finallywitdh;</span><br><span class="line">	<span class="keyword">switch</span>(type)&#123;</span><br><span class="line">		 <span class="keyword">case</span> <span class="string">&#x27;Full&#x27;</span>:</span><br><span class="line">			 finallywitdh = <span class="string">&#x27;100%&#x27;</span></span><br><span class="line">			 <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;Overlay&#x27;</span>:</span><br><span class="line">			finallywitdh = <span class="string">&#x27;250px&#x27;</span></span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(open)&#123;	</span><br><span class="line">		<span class="title function_">setWidth</span>(finallywitdh)</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="title function_">setWidth</span>(<span class="number">0</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;,[open])</span><br></pre></td></tr></table></figure><p>åœ¨é€™å€‹ Navbar ä¾‹å­ä¸­ï¼Œæˆ‘ä½¿ç”¨ HOC åœ¨åŒ…è£¹è‘—å¦ä¸€å€‹ HOCï¼Œè®“å…ƒä»¶å¯ä»¥å¾€ä¸Šè¿½åŠ æƒ³è¦çš„è³‡æ–™æˆ–åŠŸèƒ½ã€‚</p><h2 id="æ…£ä¾‹-ä½¿ç”¨-HOC-å‚³éä¸ç›¸é—œçš„-props">æ…£ä¾‹ : ä½¿ç”¨ HOC å‚³éä¸ç›¸é—œçš„ props</h2><p>æ…£ä¾‹æ˜¯ React å®˜æ–¹å»ºè­°çš„æ“ä½œç¿’æ…£ã€‚<br> <a href="https://zh-hant.reactjs.org/docs/higher-order-components.html#convention-pass-unrelated-props-through-to-the-wrapped-component">ğŸ”—ç« ç¯€é€£çµ</a></p><p>æœ‰äº› props å‚³é€²ä¾†å¯èƒ½æ˜¯ <strong>ä½œç‚ºé‹ç®—ä½¿ç”¨</strong>ï¼Œå‚³å…¥çš„ props ä¸¦éå…¨éƒ¨éƒ½è¦å‚³é€² <code>&lt;WrappedComponent/&gt;</code> è€Œæ˜¯ç¶“éä¸€äº›é‹ç®—å¾Œç•™ä¸‹ <code>&lt;WrappedComponent/&gt;</code> éœ€è¦çš„ã€‚</p><p>é€šå¸¸æœƒå‚³çµ¦ <code>&lt;WrappedComponent/&gt;</code> çš„ props é€šå¸¸æ˜¯ state æˆ–æ˜¯åœ¨ HOC å®šç¾©çš„ methodã€‚</p><blockquote><p>é‡é»åœ¨æ–¼ <strong>åªé—œæ³¨æƒ³è¦çš„è³‡æ–™</strong>ï¼Œå¯ä»¥åœ¨ HOC å‚³å…¥ä¸ç›¸é—œçš„æ²’é—œä¿‚ï¼ŒHOC çš„ props å‚³è‡³ <code>&lt;WrappedComponent/&gt;</code> ä¹‹å‰å¯ä»¥ç¯©é¸å‡ºå“ªäº› props è¦ç¹¼çºŒå‚³ä¸‹å»ã€‚</p></blockquote><p>é€™æ¨£çš„å¥½è™•æ˜¯è®“ HOC æ›´åŠ å½ˆæ€§åŒ–ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">/* </span></span><br><span class="line"><span class="comment">	  props å‚³é€²ä¾†çš„ä¸ä¸€å®šè·Ÿ WrappedComponent æœ‰ç›´æ¥é—œä¿‚ï¼ŒHOC æ˜¯ä¸€å€‹å®¹å™¨ï¼Œå°‡é—œæ³¨æ–¼æƒ³è¦çš„è³‡æ–™å‚³çµ¦ WrappedComponent</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">const</span> &#123; extraProp, ...passThroughProps &#125; = <span class="variable language_">this</span>.<span class="property">props</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* </span></span><br><span class="line"><span class="comment">	  ç‰¹åˆ¥æå‡ºè¦è¢«å‚³å…¥çš„ propsï¼Œé€šå¸¸æ˜¯ state æˆ–æ˜¯ methods </span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">const</span> injectedProp = someStateOrInstanceMethod;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç”¨ props å‚³çµ¦ WrappedComponent</span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">WrappedComponent</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">injectedProp</span>=<span class="string">&#123;injectedProp&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#123;<span class="attr">...passThroughProps</span>&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    /&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥å®˜æ–¹çš„ä¾‹å­ä¾†èªªï¼ŒHOC åŒ…å«è³‡æ–™ï¼Œä½†æ˜¯è³‡æ–™åœ¨ A å…ƒä»¶ä¸­åªè¦ a éƒ¨åˆ†ï¼ŒB å…ƒä»¶ä¸­åªè¦ b éƒ¨åˆ†ï¼Œä½†ä»–å€‘çš„ <strong>ä¾†æºéƒ½æ˜¯åŒä¸€å€‹è³‡æ–™</strong>ã€‚</p><p>é€™æ™‚å€™å¯ä»¥é€éå‚³å…¥çš„ prop æ‹¿å‡ºä¸åŒçš„è³‡æ–™ï¼Œå‚³é€² <code>&lt;WrappedComponent/&gt;</code>ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">withData</span> = (<span class="params">Component,data</span>)=&gt;&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function">(<span class="params">props</span>)=&gt;</span>&#123;</span><br><span class="line">		<span class="comment">// 1. ä¸åŒçš„ props æŠ½å‡ºä¾†</span></span><br><span class="line">		<span class="keyword">const</span> &#123;dataType,...restprops&#125; = props</span><br><span class="line">		<span class="comment">// 2. æŒ‰ç…§ type å†ä¾†å–å‡ºä¸åŒçš„ data</span></span><br><span class="line">		<span class="keyword">const</span> needData = data.<span class="title function_">filter</span>( <span class="function"><span class="params">x</span> =&gt;</span> x === dataType)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Component</span> <span class="attr">data</span>=<span class="string">&#123;needData&#125;</span> &#123;<span class="attr">...restprops</span>&#125;/&gt;</span></span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€é–‹å§‹æˆ‘æœ‰é»çœ‹ä¸æ‡‚é€™å€‹ä¾‹å­ï¼Œæƒ³ä¸åˆ°æ‡‰ç”¨çš„ä¾‹å­ã€‚åŸæœ¬åªçŸ¥é“å¯ä»¥ <strong>åŠ åŠŸèƒ½</strong>ï¼Œä½†æ²’æœ‰æƒ³éé¡ä¼¼åˆ†é¡ç¯©çš„æ¦‚å¿µï¼Œç¶“éå¹¾æ¬¡çš„å¯¦ä½œçªç„¶å°±æ‚Ÿäº†ğŸ˜‚ã€‚</p><h2 id="æ…£ä¾‹-æœ€å¤§åŒ–çš„å¯çµ„åˆæ€§-Maximizing-Composability">æ…£ä¾‹ : æœ€å¤§åŒ–çš„å¯çµ„åˆæ€§ (Maximizing Composability)</h2><p>HOC çš„å¯«æ³•å¯ä»¥åªå›å‚³ä¸€å€‹åƒæ•¸ï¼Œä¹Ÿå¯ä»¥å›å‚³å¥½å¹¾å€‹åƒæ•¸ã€‚HOC ä¸¦æ²’æœ‰ç‰¹åˆ¥é™åˆ¶å‚³éçš„åƒæ•¸é‡ï¼Œä½†æ˜¯é‚£é¡¯å¾—å¾ˆå†—é•·ï¼Œç›¡å¯èƒ½è®“ HOC åªæ¥æ”¶ä¸€å€‹åƒæ•¸ã€‚</p><p>åƒ React-reduxï¼Œä½¿ç”¨ <code>connect()()</code> é€™æ¨£å‘ˆç¾</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">ConnectedComment</span> = <span class="title function_">connect</span>(commentSelector, commentActions)(<span class="title class_">CommentList</span>);</span><br></pre></td></tr></table></figure><p>æŠŠä¸Šé¢çš„åˆ†é–‹è§£æ :</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// connect æ˜¯ä¸€å€‹ function ï¼ŒåŠŸèƒ½æ˜¯å›å‚³å¦ä¸€å€‹ function</span></span><br><span class="line"><span class="keyword">const</span> enhance = <span class="title function_">connect</span>(commentListSelector, commentListActions);</span><br><span class="line"><span class="comment">// å›å‚³çš„æ˜¯ä¸€å€‹ HOCï¼Œæ˜¯è·Ÿ Redux store é€£çµçš„ Component</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ConnectedComment</span> = <span class="title function_">enhance</span>(<span class="title class_">CommentList</span>);</span><br></pre></td></tr></table></figure><blockquote><p>ç°¡å–®ä¾†èªª : HOC åŒ…ä½å¦ä¸€å€‹ HOC</p></blockquote><p>å¦‚æœ HOC æ•¸é‡ä¸€å¤šï¼Œå¯«èµ·ä¾†å°±æœƒè®Šå¾—å¾ˆå†—é•·ï¼Œé€™æ™‚å€™å¯ä»¥é‹ç”¨ compose (çµ„åˆ) çš„æ¦‚å¿µ</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ğŸ˜µ ä¸æ‡‰è©²ä¸€å±¤åŒ…ä¸€å±¤</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">EnhancedComponent</span> = <span class="title function_">withRouter</span>(<span class="title function_">connect</span>(commentSelector)(<span class="title class_">WrappedComponent</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯ä»¥é‹ç”¨ä¸€å€‹ function å°‡å‚³å…¥çš„ HOC æ‰“åŒ…æˆæ†ï¼Œcompose æ˜¯åˆ¥è™•åœ°å®šç¾©çµ„åˆ function çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">const</span> enhance = <span class="title function_">compose</span>(</span><br><span class="line">  <span class="comment">// é€™é‚Šçš„ HOC åªæ¥æ”¶ä¸€å€‹åƒæ•¸</span></span><br><span class="line">  withRouter,</span><br><span class="line">  <span class="title function_">connect</span>(commentSelector)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">EnhancedComponent</span> = <span class="title function_">enhance</span>(<span class="title class_">WrappedComponent</span>)</span><br></pre></td></tr></table></figure><p>ä¹Ÿæœ‰å…¶ä»–çš„ library å¯ä»¥å¹«åŠ©æŠŠ HOCs æ‰“åŒ…æˆæ†ï¼Œä¾‹å¦‚ :</p><ul><li>lodash.flowRight</li><li>Redux</li><li>Ramda</li></ul><h2 id="æ…£ä¾‹-ç”¨-displayName-å–åå­—å¹«åŠ©-Debug">æ…£ä¾‹ : ç”¨ displayName å–åå­—å¹«åŠ© Debug</h2><p>HOCs æ˜¯ Container çš„æ¦‚å¿µï¼Œå¦‚æœçµæ§‹ä¸Šæ˜¯ä½¿ç”¨ :</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">withToggle</span> = (<span class="params">WrappedComponent</span>)=&gt; <span class="function">(<span class="params">props</span>)=&gt;</span> &#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;<span class="attr">...props</span>&#125;/&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒ¿åçš„ arrow functionï¼Œåœ¨ Debug æœƒå‚»å‚»æä¸æ¸…æ¥šã€‚</p><p>å¾å¯¦ä½œç¯„ä¾‹æ‰“é–‹ devtool ä¾†çœ‹ï¼Œç”¨ HOC åŒ…éçš„å…ƒä»¶éƒ½åªé¡¯ç¤º <strong>Anonymous</strong><br> <img data-src="https://i.imgur.com/V4Uk0fb.png" alt="|200x250"></p><p>Navbar æœ‰ <code>Full</code> è·Ÿ <code>Overlay</code> å…©ç¨®ï¼Œä½†åœ¨é€™é‚Šæ˜¯çœ‹ä¸å‡ºä¾†çš„ã€‚ä¸»è¦åŸå› å°±æ˜¯ä¸Šé¢æåˆ°çš„çµæ§‹ï¼Œé‡é»æ˜¯ <strong>è®“å…§éƒ¨çš„ function æ“æœ‰åå­—</strong>ï¼Œå¿…é ˆç¨ç«‹å‡ºä¾†ã€‚å¯ä»¥å…ˆæŠŠå®ƒä¸€æ­¥æ­¥çµ¦è§£é–‹ä¾†</p><ul><li>åœ¨å…§éƒ¨å–å :</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">withToggle</span> = (<span class="params">WrappedComponent</span>)=&gt; &#123;</span><br><span class="line">	<span class="comment">// ç¬¬ä¸€ç¨® : ç›´æ¥å¯«æˆ function statements</span></span><br><span class="line">	<span class="keyword">function</span> <span class="title function_">newComponent</span>(<span class="params">props</span>)&#123;</span><br><span class="line">		<span class="comment">//...</span></span><br><span class="line">		<span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;<span class="attr">...props</span>&#125;/&gt;</span></span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// ç¬¬äºŒç¨® : å¯«æˆ function expressions</span></span><br><span class="line">	<span class="keyword">const</span> <span class="title function_">newComponent</span> = (<span class="params">props</span>)=&gt;&#123;</span><br><span class="line">		<span class="comment">//...</span></span><br><span class="line">		<span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;<span class="attr">...props</span>&#125;/&gt;</span></span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 1. è®“è¢«åŒ…æˆ HOC çš„å…ƒä»¶æ‹¿åˆ°åŸæœ¬ WrappedComponent çš„åç¨±(ä¾‹å¦‚ : &quot;Navbar&quot;)</span></span><br><span class="line">	newComponent.<span class="property">displayName</span> = <span class="string">`withNavbarType(<span class="subst">$&#123;getDisplayName(WrappedComponent)&#125;</span>)`</span></span><br><span class="line">	<span class="keyword">return</span> newComponent</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 2. å®˜æ–¹å¯«æ³• : è®€å–åˆ°è¢«åŒ…è£¹çš„å…ƒä»¶åŸåç¨± */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getDisplayName</span>(<span class="params">WrappedComponent</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">WrappedComponent</span>.<span class="property">displayName</span> || <span class="title class_">WrappedComponent</span>.<span class="property">name</span> || <span class="string">&#x27;Component&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¤–éƒ¨å‘½å : ç›´æ¥æ›¿ç”Ÿç”¢å‡ºä¾†çš„ HOC å‘½å</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¬¬ä¸€ç¨® : ç›´æ¥é™„åŠ å±¬æ€§</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AccordionwithToggle</span> =  <span class="title function_">withToggle</span>(<span class="title class_">Accordion</span>);</span><br><span class="line"><span class="title class_">AccordionWithToggle</span>.<span class="property">displayName</span> = <span class="string">&quot;withToggleAccordion&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬äºŒç¨® : Object.assignï¼Œç‰©ä»¶ä¸Š + ç‰©ä»¶å±¬æ€§</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AccordionwithToggle</span> = <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="title function_">withToggle</span>(<span class="title class_">Accordion</span>),&#123;</span><br><span class="line">	<span class="attr">displayName</span>: <span class="string">&#x27;withToggleAccordion&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><img data-src="https://i.imgur.com/e3103Wo.png" alt="|250x250"><br> <code>withToggle</code> æˆ‘æ²’æœ‰åœ¨å…§éƒ¨å‘½åï¼Œè€Œæ˜¯åœ¨ <code>Accordion</code> HOC ä¸Šå‘½åï¼Œæ‰€ä»¥è‡ªç„¶åœ¨ <code>Navbar</code> withToggle æœƒçœ‹åˆ°åŒ¿åã€‚</p><p>displayName é€™å€‹å±¬æ€§æ˜¯ React æä¾›æˆ‘å€‘æ›¿ Component å–ä¸åŒçš„åç¨±æ™‚ï¼Œåœ¨ devtools ä¸Šè§€å¯Ÿï¼Œæ–¹ä¾¿ Debugã€‚<br> å¦‚æœæœ‰ä½¿ç”¨ Context API ï¼Œå…¶å¯¦ä¹Ÿæ˜¯åŒå€‹æ¦‚å¿µï¼ŒContext ä¸­çš„ Provider å¯ä»¥æ”¾åœ¨ APP ä»¥ä¸‹çš„æ¨¹ç‹€ä½ç½®ï¼Œä¹Ÿå¯èƒ½å‡ºç¾è¤‡æ•¸å€‹ï¼Œé€™æ™‚å€™å¯ä»¥æ›¿ Context å‘½åæ–¹ä¾¿æŸ¥çœ‹ã€‚</p><p>åœ¨å…§éƒ¨å–åå°±æ˜¯è®“ function éœ²å‡ºåå­—ï¼Œé›–ç„¶ <code>function expressions</code> å°æ–¼å…§éƒ¨æ˜¯åŒ¿åçš„ï¼Œä½†æˆ‘å€‘åªåœ¨ä¹æœ€å¤–éƒ¨ function çš„åç¨±ã€‚</p><p>å¦å¤–åƒä¸Šé¢å¯«çš„ <code>withNavbarType()</code> é€™æ¨£åŒ…è£¹èµ·ä¾†ï¼Œæ‹¬è™Ÿä»¥å¤–çš„æœƒåœ¨å¤–éƒ¨ (åœ–ä¸­ç°è‰²æ–¹å¡Šå€)ï¼Œé¡ä¼¼ Component çš„é™„åŠ è¨Šæ¯ï¼Œä½†è¢«æ‹¬è™ŸåŒ…è£¹ä½çš„æœ€è£¡é¢æ‰æ˜¯é¡¯ç¤ºå…ƒä»¶çš„ displayNameã€‚</p><h2 id="æ³¨æ„-ä¸è¦ç›´æ¥ä¿®æ”¹åˆ°åŸæœ¬çš„-Component">æ³¨æ„ : ä¸è¦ç›´æ¥ä¿®æ”¹åˆ°åŸæœ¬çš„ Component</h2><ul><li><p>å‡å¦‚æˆ‘å€‘è¦æ“ä½œæœ‰é—œå…ƒä»¶çš„ç”Ÿå‘½é€±æœŸï¼Œä¸æ‡‰è©²ç›´æ¥ä¿®æ”¹å…ƒä»¶çš„ prototype</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âŒ å£é€äº†</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">logProps</span>(<span class="params">InputComponent</span>) &#123;</span><br><span class="line">  <span class="title class_">InputComponent</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">componentDidUpdate</span> = <span class="keyword">function</span>(<span class="params">prevProps</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Current props: &#x27;</span>, <span class="variable language_">this</span>.<span class="property">props</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Previous props: &#x27;</span>, prevProps);</span><br><span class="line">  &#125;;</span><br><span class="line">	<span class="comment">// InputComponent æœ¬èº«å·²ç¶“è¢«æ”¹è®Š</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">InputComponent</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// EnhancedComponent will log whenever props are received</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">EnhancedComponent</span> = <span class="title function_">logProps</span>(<span class="title class_">InputComponent</span>);</span><br></pre></td></tr></table></figure><p>å°è‡´æ‰€æœ‰å‚³é€²ä¾†çš„ Component è¢«æ”¹è®Šï¼Œ<code>componentDidUpdate</code> é€™å€‹æ–¹æ³•éƒ½è¢« ä¿®æ”¹/è¦†å¯« äº†ï¼ŒHOC ä¸èƒ½è¢«é‡è¤‡ä½¿ç”¨ï¼Œå› ç‚º function component ä¸¦æ²’æœ‰ç”Ÿå‘½é€±æœŸçš„æ–¹æ³•ã€‚</p></li><li><p>åˆ©ç”¨ composition çš„æ¦‚å¿µ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âœ… composition</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">logProps</span>(<span class="params">WrappedComponent</span>) &#123;</span><br><span class="line">	<span class="comment">// ç”¨æ–°çš„ Component åŒ…è£¹å‚³å…¥çš„ Componentï¼Œä¸å»å½±éŸ¿åˆ°åŸæœ¬çš„ Component</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">class</span> <span class="title class_">extends</span> <span class="title class_">React</span>.<span class="property">Component</span> &#123;</span><br><span class="line">    <span class="title function_">componentDidUpdate</span>(<span class="params">prevProps</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Current props: &#x27;</span>, <span class="variable language_">this</span>.<span class="property">props</span>);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Previous props: &#x27;</span>, prevProps);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;<span class="attr">...this.props</span>&#125; /&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="æ³¨æ„-ä¸è¦åœ¨-render-function-ä½¿ç”¨-HOC">æ³¨æ„ : ä¸è¦åœ¨ render function ä½¿ç”¨ HOC</h2><p>function æ˜¯ Object çš„ä¸€ç¨®ï¼Œæ¯æ¬¡ re-render éƒ½æ˜¯æ–°çš„ function (object)ï¼Œé€ æˆæ•ˆèƒ½ä¸Šçš„æµªè²»ã€‚æ‰€ä»¥è¦åœ¨å¤–éƒ¨ç”¢ç”Ÿ HOC å†å¸¶å…¥æ–°çš„ Component ä¸­ã€‚</p><blockquote><p>ç°¡å–®ä¾†èªª : <strong>{ } !== { }</strong>ï¼Œè¦é¿å…é€™ç¨®æƒ…æ³ç™¼ç”Ÿ</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// âœ… é€™æ˜¯ ok çš„ï¼ŒAccordionwithToggle ä¸æœƒå› ç‚º App re-render è€Œæ”¹è®Š</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AccordionwithToggle</span> = <span class="title class_">React</span>.<span class="title function_">memo</span>(<span class="title function_">withToggle</span>(<span class="title class_">Accordion</span>))</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">const</span> [count,setCount] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line">	<span class="keyword">return</span> (</span><br><span class="line">		<span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">			<span class="tag">&lt;<span class="name">AccordionwithToggle</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">			<span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>&#123; setCount(count+1) &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">	)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// âŒ æ¯æ¬¡ App re-render éƒ½æ˜¯é‡æ–°å‘¼å« function,ç”¢ç”Ÿæ–°çš„ Accordionï¼ŒReact æœƒå°‡å…¨éƒ¨æ›¿æ›ï¼Œå› ç‚ºè·Ÿä¸Šä¸€æ¬¡çš„ Accordion ä¸ä¸€æ¨£ã€‚</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="keyword">const</span> [count,setCount] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line">	<span class="comment">// æ¯æ¬¡éƒ½æ˜¯æ–°çš„</span></span><br><span class="line">	<span class="keyword">const</span> <span class="title class_">AccordionwithToggle</span> = <span class="title class_">React</span>.<span class="title function_">useMemo</span>(<span class="title function_">withToggle</span>(<span class="title class_">Accordion</span>),[])</span><br><span class="line">	<span class="keyword">return</span> (</span><br><span class="line">		<span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">			<span class="tag">&lt;<span class="name">AccordionwithToggle</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">			<span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>&#123; setCount(count+1) &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">	)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>codepen ä¸­é è¨­çš„å¼•å…¥çš„ React script æ˜¯ production modeï¼Œæ˜¯ä¸èƒ½ä½¿ç”¨ React çš„ profilerâ€¦ çš„ã€‚<br> è¦éº¼æ”¹æˆ developmentï¼Œåœ¨ html æ·»åŠ é€™å…©è¡Œï¼Œä¸¦ä¸”æŠŠç·¨è¼¯å™¨çš„ <code>External Scripts/Pens</code> å–æ¶ˆã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">crossorigin</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react@18/umd/react.development.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">crossorigin</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react-dom@18/umd/react-dom.development.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>in render<br> <img data-src="https://i.imgur.com/GgF9oDS.gif" alt="|600x350"></li><li>outside<br> <img data-src="https://i.imgur.com/j4Uec3j.gif" alt="|600x350"></li></ul><p>ä»¥è‚‰çœ¼ä¾†çœ‹ï¼Œç•¶ App çš„ state æ”¹è®Šï¼Œé€²è¡Œ re-renderï¼Œå¦‚æœæ˜¯åœ¨ render ç”¢ç”Ÿçš„ <code>&lt;Accordion/&gt;</code>æœƒé–ƒä¸€ä¸‹ï¼Œå› ç‚ºå° App ä¾†èªª <code>&lt;Accordion/&gt;</code> æ˜¯æ–°ç‰©ä»¶ï¼Œç­‰åŒæ–¼ç”¢ç”Ÿæ–°çš„ DOM ç¯€é» ä¸¦ä¸” repaint ã€‚æ”¾åœ¨å¤–éƒ¨çš„è©±ï¼Œå°±æ²’æœ‰é€™å€‹å•é¡Œã€‚</p><h2 id="æ³¨æ„-refs-ä¸¦ä¸æœƒè¢«å‚³é">æ³¨æ„ : refs ä¸¦ä¸æœƒè¢«å‚³é</h2><p><strong>refs</strong> ä¸æ˜¯ props çš„ä¸€ç¨®ï¼Œå°±åƒ <code>key</code>ï¼Œæ˜¯ç”± React ä¾†æ§åˆ¶çš„ã€‚å°±åƒä½ ä¸èƒ½åœ¨å­å…ƒä»¶ä¸­æ‹¿åˆ° <code>âŒprops.key</code>ã€‚å¦‚æœåœ¨ HOC ä½¿ç”¨ refï¼Œæ¥æ”¶åˆ° ref çš„ä¸æœƒæ˜¯ WrappedComponentï¼Œè€Œæ˜¯ HOC æœ¬èº«ã€‚</p><p>è¦ä½¿ WrappedComponent èƒ½å¤ æ¥æ”¶ ref ï¼Œå¿…é ˆä½¿ç”¨ <code>React.forwardRef</code><sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>ã€‚</p><p><code>React.forwardRef</code> åŒ…ä½çš„ Component å¯ä»¥æ¥æ”¶ <strong>ref</strong> (é€™è£¡çš„ ref æ˜¯ forwardRef åˆ»æ„ç‚ºä¹‹)ã€‚</p><ul><li><code>withtoggle</code> ç‚ºä¾‹ï¼Œæ”¹æˆ <strong>withToggle2</strong></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">withToggle2</span> = (<span class="params">Component</span>) =&gt; &#123;</span><br><span class="line">	<span class="comment">/* æ¥ä½ä¸Šå±¤å‚³ä¸‹ä¾†çš„ ref */</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">React</span>.<span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props, ref</span>)=&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> [open, setOpen] = <span class="title class_">React</span>.<span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">togglehandler</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="title function_">setOpen</span>(<span class="function">(<span class="params">prevOpen</span>) =&gt;</span> !prevOpen);</span><br><span class="line">    &#125;;</span><br><span class="line">	    <span class="comment">/* ğŸ˜µ Wrapped Component ä¸èƒ½ä½¿ç”¨ ref é€™å€‹å­—çœ¼æ¥ ref ï¼Œè¦å–åˆ¥åæ¥ */</span></span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Component</span> <span class="attr">open</span>=<span class="string">&#123;open&#125;</span> <span class="attr">togglehandler</span>=<span class="string">&#123;togglehandler&#125;</span> &#123;<span class="attr">...props</span>&#125; <span class="attr">forwardRef</span>=<span class="string">&#123;ref&#125;</span> /&gt;</span></span>;</span><br><span class="line">    &#125;) </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// App ç”¢ç”Ÿæ–°çš„ ref</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title class_">SpecialRef</span> = <span class="title class_">React</span>.<span class="title function_">useRef</span>(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* ä½¿ç”¨ ref ç›´æ¥å‚³ */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">AccordionwithToggle2</span> <span class="attr">index</span>=<span class="string">&quot;special&quot;</span> <span class="attr">ref</span>=<span class="string">&#123;SpecialRef&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨ Wrapped Component å¾ prop æ¥æ”¶ ref </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Accordion</span>(<span class="params">&#123; open, togglehandler, index,forwardRef &#125;</span>) &#123;</span><br><span class="line">  <span class="comment">// ç•¥</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(forwardRef) <span class="comment">// çµæœ hello</span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">	  <span class="comment">//...ç•¥</span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåªæœ‰åœ¨ç”¢ç”Ÿ Ref çš„åŒä¸€å±¤å¯ä»¥ç›´æ¥ä½¿ç”¨ ref ï¼Œä¾‹å¦‚ :</p><ul><li>App åœ¨é€™è£¡ <code>createref / useRef</code> ğŸ‘‰ <code>&lt;AccordionwithToggle2 ref=&#123;âœ…&#125; /&gt;</code></li><li>HOC è£¡é¢çš„ <code>&lt;WrappedComponent/&gt;</code> ä¸èƒ½ä½¿ç”¨ ref å‚³ï¼Œè¦å–åˆ¥åã€‚ HOC ğŸ‘‰<code>&lt;WrappedComponent ref=&#123;âŒ&#125; forwardref=&#123;âœ…&#125; /&gt;</code></li></ul><h2 id="ç¸½çµ-26">ç¸½çµ</h2><p>é—œæ–¼ HOC çš„ç‰¹é»</p><ol><li>æ˜¯ä¸€å€‹ Design Pattern ï¼Œå¯ä»¥æé«˜ Component é‡è¤‡æ€§</li><li>æ˜¯ä¸€å€‹ function ï¼ŒåŒ…è£¹å¦ä¸€å€‹ Componentï¼Œå›å‚³æ–°çš„ Componentï¼Œåˆç¨± <strong>åŠ å¼·ç‰ˆ Component</strong>ï¼Œä¸¦ä¸”ä¸æœƒå½±éŸ¿åˆ°åŒ…ä½çš„ Component ã€‚</li></ol><p>HOC æœ€å¸¸æ¯”è¼ƒçš„é‚„æœ‰ render props é€™å€‹ Patternï¼Œå·®åˆ¥å¯ä»¥åƒè€ƒ</p><ul><li><a href="https://medium.com/frochu/hoc-%E8%88%87renderprops-%E8%AB%87%E6%88%91%E5%BE%9E%E5%A5%B9%E5%80%91%E8%BA%AB%E4%B8%8A%E5%AD%B8%E5%88%B0%E4%BB%80%E9%BA%BC-2681ab4cc453">HOC èˆ‡Render Propsï¼Œè«‡æˆ‘å¾å¥¹å€‘èº«ä¸Šå­¸åˆ°ä»€éº¼. å‰è¨€ | by Wendell Liu | Frochu | Medium</a></li><li><a href="https://gist.github.com/heygrady/f9bf3b6dd93fe3d87ba87430fd3c20d5">Avoiding HOC; Favoring render props Â· GitHub</a></li></ul><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none;padding-left:0"><li id="fn:1"><span style="display:inline-block;vertical-align:top;padding-right:10px">1.</span><span style="display:inline-block;vertical-align:top">è£œå…… HOC çš„ ref å•é¡Œ : <a href="https://zh-hant.reactjs.org/docs/forwarding-refs.html#forwarding-refs-in-higher-order-components">å‚³é€ Ref â€“ React</a></span> <a href="#fnref:1" rev="footnote">â†©</a></li></ol></div></div></div><div class="popular-posts-header">ç›¸é—œæ–‡ç« </div><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><a href="\2022\04\04\Practice-to-Master-01.html" rel="bookmark">ç´€éŒ„ | Frontend Mentor æŒ‘æˆ°é¡Œ - Time tracking dashboard</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="\2022\07\React\ContextAPI.html" rel="bookmark">ç­†è¨˜ | React - Context API</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="\2022\07\React\Render-props.html" rel="bookmark">ç­†è¨˜ | React - render props</a></div></li><li class="popular-posts-item"><div class="popular-posts-title"><a href="\2022\08\React\react-useEffect-about-everythings.html" rel="bookmark">ç­†è¨˜ | React - é‡æ–°äº†è§£ useEffect</a></div></li></ul><footer class="post-footer"><div class="post-tags"><a href="/tags/React/" rel="tag"><i class="fa fa-tag"></i> React</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2022/06/JavaScript/JavaScript-fetch" rel="prev" title="ç­†è¨˜ | JavaScript - fetch ç²å–é ç«¯è³‡æ–™"><i class="fa fa-chevron-left"></i> ç­†è¨˜ | JavaScript - fetch ç²å–é ç«¯è³‡æ–™</a></div><div class="post-nav-item"> <a href="/2022/07/React/ContextAPI" rel="next" title="ç­†è¨˜ | React - Context API">ç­†è¨˜ | React - Context API<i class="fa fa-chevron-right"></i></a></div></div></footer></article><div style=""><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2022</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">RosaHong</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i></span> <span>ç¸½å­—æ•¸ï¼š</span> <span title="ç¸½å­—æ•¸">231k</span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span>æ‰€éœ€ç¸½é–±è®€æ™‚é–“ &asymp;</span> <span title="æ‰€éœ€ç¸½é–±è®€æ™‚é–“">3:30</span></span></div><div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> å¼·åŠ›é©…å‹•</div></div></footer><script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="//cdn.jsdelivr.net/npm/lozad@1.15.0/dist/lozad.min.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script>
if (document.querySelectorAll('.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8.7.0/dist/mermaid.min.js', () => {
    mermaid.init({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    }, '.mermaid');
  }, window.mermaid);
}
</script><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"></body></html>